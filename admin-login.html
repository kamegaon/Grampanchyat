 <!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Kamegaon</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { font-family: Arial,sans-serif; margin:0; padding:20px; background:#f9f9f9; color:#333; display:flex; flex-direction:column; align-items:center;}
h1,h2 {text-align:center; color:#222;}
input,textarea,button { width:300px; max-width:90%; margin:8px 0; padding:10px; border-radius:8px; border:none; font-size:15px; }
textarea { height:100px; resize:vertical; }
button { background:#f0f0f0; cursor:pointer; border-radius:10px; box-shadow:3px 3px 8px rgba(0,0,0,0.2), -3px -3px 8px rgba(255,255,255,0.7); transition:0.2s; }
button:hover { transform:translateY(-2px); box-shadow:5px 5px 10px rgba(0,0,0,0.2), -5px -5px 10px rgba(255,255,255,0.7);}
.card { background:#fff; border-radius:12px; padding:15px; margin:10px 0; width:90%; max-width:600px; box-shadow:4px 4px 12px rgba(0,0,0,0.1), -4px -4px 12px rgba(255,255,255,0.6);}
.dashboard-container { width:90%; max-width:900px; margin:20px auto; display:flex; flex-direction:column; align-items:center;}
#loginForm { display:flex; flex-direction:column; align-items:center; }
#signOut { margin-top:15px; background:#e0e0e0; color:#444;}
label { font-weight:bold; margin-top:10px; display:block;}
</style>
</head>
<body>

<h1>Admin - Kamegaon</h1>

<div id="loginForm">
  <h2>Admin Login</h2>
  <label>Email</label>
  <input id="email" type="email" placeholder="admin@example.com">
  <label>Password</label>
  <input id="password" type="password" placeholder="********">
  <button id="loginBtn"><i class="fas fa-sign-in-alt"></i> Login</button>
</div>

<div id="dashboard" style="display:none;">
  <button id="signOut"><i class="fas fa-sign-out-alt"></i> Sign Out</button>

  <div class="dashboard-container">
    <h2>नवीन सूचना जोडा</h2>
    <label>शीर्षक (optional)</label>
    <input id="title" placeholder="उदा: पाणीपुरवठा सूचना">
    <label>संदेश</label>
    <textarea id="message" placeholder="संदेश येथे टाका..."></textarea>
    <button id="save">सुरक्षित करा</button>
  </div>

  <div class="dashboard-container">
    <h2>सूचना यादी</h2>
    <ul id="noticeList"></ul>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

<script>
// Firebase Config
    const firebaseConfig = {
  apiKey: "AIzaSyBvTQvsSsy4nq-xknFYQmiVcdTOSIQ9T-c",
  authDomain: "panchayatsetu.firebaseapp.com",
  projectId: "panchayatsetu",
  storageBucket: "panchayatsetu.firebasestorage.app",
  messagingSenderId: "1082762014645",
  appId: "1:1082762014645:web:ef3a343c8d75907aba73fc"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// LOGIN
document.getElementById('loginBtn').onclick = async () => {
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();
  if(!email||!password){ alert('सर्व फील्ड भरा'); return; }
  try {
    const userCred = await auth.signInWithEmailAndPassword(email,password);
    const adminDoc = await db.collection('admins').doc(email).get();
    if(!adminDoc.exists){ alert('आपण अधिकृत प्रशासक नाही'); auth.signOut(); return; }
    document.getElementById('loginForm').style.display='none';
    document.getElementById('dashboard').style.display='block';
    loadNotices();
  } catch(e){ alert('Login Failed: '+e.message); }
};

// SIGN OUT
document.getElementById('signOut').onclick = async () => {
  await auth.signOut();
  document.getElementById('dashboard').style.display='none';
  document.getElementById('loginForm').style.display='flex';
};

// ADD / SAVE NOTICE
document.getElementById('save').onclick = async () => {
  const title = document.getElementById('title').value;
  const message = document.getElementById('message').value;
  if(!message.trim()){ alert('संदेश रिक्त राहू शकत नाही'); return; }
  await db.collection('notifications').add({
    title, message,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  });
  document.getElementById('title').value='';
  document.getElementById('message').value='';
  loadNotices();
};

// LOAD NOTICES
async function loadNotices(){
  const ul = document.getElementById('noticeList');
  ul.innerHTML='';
  const snapshot = await db.collection('notifications').orderBy('createdAt','desc').get();
  snapshot.forEach(doc=>{
    const data=doc.data();
    const li=document.createElement('li');
    li.className='card';
    li.innerHTML=`<strong>${data.title||''}</strong><br>${data.message}`;
    ul.appendChild(li);
  });
}
</script>
</body>
</html>

